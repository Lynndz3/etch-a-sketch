<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Etch-A-Sketch</title>
    <link rel="stylesheet" href="styles.css">

</head>
<body>
    <h1>Etch-A-Sketch</h1>
    <div class="container"></div>
    <div class="slidecontainer">
        <p><span id="grid-size"></span></p>
        <input type="range" min="2" max="100" value="16" class="slider" id="myRange">
      </div>
    <button onclick="clearContents()">Clear</button>
    
      <button>
    <label for="colorpicker">Color Picker:</label>
    <input type='color' id="colorpicker" value="#000000"></button>
    <span>OR</span>
    <button id="rainbow-mode">Rainbow!</button>

    <script>
        const container = document.querySelector('.container');

        const cells = document.getElementsByClassName('cells');

        makeRows(16, 16);

        function makeRows(rows, columns) {
            container.style.setProperty('--grid-rows', rows);
            container.style.setProperty('--grid-cols', columns);
            for (let i = 0; i < (rows * columns); i++) {
                const cell = document.createElement("div");
                cell.className = 'cells';
                container.appendChild(cell);
            };
        };

        let color = document.querySelector('#colorpicker').value;
        document.querySelector('#colorpicker').addEventListener('change', (e) => {
            color = e.target.value;
            console.log(color);
            return color;
        });

        let rainbowOption = document.querySelector('#rainbow-mode');
       
        rainbowOption.addEventListener("click", function() {
            console.log(this);
            if (this.classList.contains("active") == true) {
                this.classList.remove("active");
            }
            else this.className = "active";
        });

        let mouseDown = false;

        container.addEventListener('mousedown', (event) => {
                mouseDown = true;
            });
        

        document.addEventListener('mouseover', (event) => {
                if (mouseDown) {
                    if (event.target.className === "cells") {
                        console.log(rainbowOption.classList.contains("active"));
                        if (rainbowOption.classList.contains("active")) {
                            event.target.style.backgroundColor =  "#" + Math.floor(Math.random()*16777215).toString(16);
                        }
                        else {
                            event.target.style.backgroundColor = color;
                        }
                        console.log(event);
                    }
                }    
            });
        document.addEventListener('mouseup', () => {
            mouseDown = false;
        });
        
    let slider = document.getElementById("myRange");
    let dimensions = document.querySelector('#grid-size');
    dimensions.textContent = slider.value + " x " + slider.value; // Display the default slider value

    // Update the current slider value (each time you drag the slider handle)
    slider.oninput = function() {
        dimensions.textContent = this.value + " x " + this.value;
        clearContents();
        makeRows(this.value, this.value);
    }

    function clearContents() {
        let allCells = document.querySelectorAll('.cells');
        for (let cell of allCells) {
            cell.style.backgroundColor = "";
        }
    }

    </script>
</body>
</html>